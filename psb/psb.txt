- Есть метод для генерации секретного ключа? (SHA1, передается отдельным параметром P_SIGN в запросах Торговых точек к платежному шлюзу)

- Есть метод для авторизации?

- Перед проведением тестирования Торговая точка сообщает URL CGI-скрипта, обрабатывающего уведомления на запросы проведения операций на эл. адреса:  ermolinsd@psbank.ru и Cherenkov@psbank.ru Что такое CGI-скрипт?

- Пример страницы Торговой точки можно посмотреть по адресу: https://test.3ds.payment.ru/sale.html

- После проведения тестирования Банк регистрирует в производственной среде Торговую точку на основании подписанного Договора с Банком. Присваивает и сообщает значение параметров TERMINAL и MERCHANT для производственной среды.

- Чистое значение секретного ключа Торговая точка получает после выполнения операции XOR над компонентами. Что такое операции XOR?

- Во избежание финансовых потерь, торговая точка обязана генерировать HMAC для каждого запроса на проведение любой операции и проверять HMAC каждого уведомления о результате проведения этих запросов.

- Банк получает запрос, проверяет HMAC (переданный параметром P_SIGN), сформированный Торговой точкой, проводит авторизацию и отправляет результат проведения операции в виде POST – запроса по оговоренному заранее (п. 2А) с Торговой точкой URL. Список отправляемых Банком параметров по результату проведения оплаты: AMOUNT, CURRENCY, ORDER, DESC, TERMINAL, TRTYPE, MERCH_NAME, MERCHANT, EMAIL, TIMESTAMP, NONCE, BACKREF,  RESULT, RC, RCTEXT, AUTHCODE, RRN, INT_REF, P_SIGN, NAME, CARD. 

- HMAC формируется в 2 этапа: 1 – формирование строки данных для HMAC. 2 – Формирование HMAC.

- Если параметр участвует в формировании HMAC, то после его обработки для формирования HMAC,  данные будут иметь вид:  (длина значения параметра)+(значение параметра). Если же параметр, участвуя в формировании HMAC, не определен (передается с неопределенным значением), то в строку для формирования HMAC передается символ «-». Формируется HMAC  по алгоритму SHA1 от подготовленной строки (в примере - 567.226123987-812365478) с использованием секретного ключа Торговой точки. Ключ должен быть упакован в бинарную строку.

